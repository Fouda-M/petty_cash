(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{172:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},285:(e,t,s)=>{"use strict";s.d(t,{$:()=>o,r:()=>d});var a=s(5155),r=s(2115),l=s(9708),i=s(2085),n=s(9434);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:i,size:o,asChild:c=!1,...u}=e,p=c?l.DX:"button",m=(0,a.jsx)(p,{className:(0,n.cn)(d({variant:i,size:o,className:s})),ref:t,...u});return c?r.Children.only(m):m});o.displayName="Button"},968:(e,t,s)=>{"use strict";s.d(t,{b:()=>n});var a=s(2115),r=s(3655),l=s(5155),i=a.forwardRef((e,t)=>(0,l.jsx)(r.sG.label,{...e,ref:t,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||(null==(s=e.onMouseDown)||s.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var n=i},1728:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var a=s(5155),r=s(6874),l=s.n(r),i=s(285),n=s(9435),d=s(172),o=s(4301),c=s(157);let u=(0,c.A)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),p=(0,c.A)("DatabaseBackup",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 12a9 3 0 0 0 5 2.69",key:"1ui2ym"}],["path",{d:"M21 9.3V5",key:"6k6cib"}],["path",{d:"M3 5v14a9 3 0 0 0 6.47 2.88",key:"i62tjy"}],["path",{d:"M12 12v4h4",key:"1bxaet"}],["path",{d:"M13 20a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L12 16",key:"1f4ei9"}]]),m=(0,c.A)("DatabaseZap",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 15 21.84",key:"14ibmq"}],["path",{d:"M21 5V8",key:"1marbg"}],["path",{d:"M21 12L18 17H22L19 22",key:"zafso"}],["path",{d:"M3 12A9 3 0 0 0 14.59 14.87",key:"1y4wr8"}]]);var f=s(2115),h=s(7481);async function x(){return console.log("backupUserTripsToServerAction called"),{success:!0,message:"Trips backed up (placeholder)",backupName:"placeholder_backup",error:void 0}}async function y(){return console.log("listUserBackupsAction called"),{success:!0,backups:[],error:void 0}}async function g(e){return console.log("restoreFromBackupAction called with backupId: ".concat(e)),{success:!0,message:"Restored from backup ".concat(e," (placeholder)"),error:void 0}}var v=s(4165),b=s(9409),j=s(5057),w=s(3013),N=s(5471);function k(){let{toast:e}=(0,h.dj)(),[t,s]=f.useState(!1),[r,c]=f.useState(!1),[k,A]=f.useState(!1),[S,M]=f.useState([]),[T,C]=f.useState(void 0),[E,_]=f.useState(!1),[z,D]=f.useState(!1),[R,O]=f.useState(!0);f.useEffect(()=>{D("true"===sessionStorage.getItem("isGuest")),O(!1)},[]);let I=async()=>{if(z)return void e({variant:"destructive",title:"غير مسموح",description:"يجب تسجيل الدخول لإنشاء نسخ احتياطية على الخادم."});s(!0);try{let t=await x();if(t.success&&t.backupName)e({title:"تم إنشاء نسخة احتياطية على الخادم",description:'تم حفظ النسخة "'.concat(t.backupName,'" بنجاح.')});else throw Error(t.error||"فشل النسخ الاحتياطي على الخادم.")}catch(t){e({variant:"destructive",title:"خطأ في النسخ الاحتياطي",description:t.message||"لم يتمكن من إنشاء نسخة احتياطية على الخادم."})}finally{s(!1)}},L=async()=>{if(!z){_(!0),C(void 0);try{let t=await y();if(t.success&&t.backups)M(t.backups),0===t.backups.length&&e({variant:"default",title:"لا توجد نسخ احتياطية",description:"لم يتم العثور على نسخ احتياطية محفوظة على الخادم."});else throw M([]),Error(t.error||"فشل في جلب قائمة النسخ الاحتياطية.")}catch(t){e({variant:"destructive",title:"خطأ في جلب النسخ",description:t.message||"لم نتمكن من جلب قائمة النسخ الاحتياطية."})}finally{_(!1)}}};f.useEffect(()=>{k&&!z&&L()},[k,z]);let P=async()=>{if(z)return void e({variant:"destructive",title:"غير مسموح",description:"يجب تسجيل الدخول لاستعادة النسخ من الخادم."});if(!T)return void e({variant:"destructive",title:"لم يتم اختيار نسخة",description:"يرجى اختيار نسخة احتياطية من القائمة أولاً."});c(!0);try{let t=await g(T);if(t.success)e({title:"تمت الاستعادة بنجاح",description:"تم استيراد بيانات رحلاتك من النسخة الاحتياطية على الخادم. قد تحتاج إلى تحديث الصفحة لرؤية التغييرات."}),A(!1),C(void 0);else throw Error(t.error||"فشل في استعادة البيانات من الخادم.")}catch(t){e({variant:"destructive",title:"خطأ في الاستعادة",description:t.message||"لم يتمكن من استعادة البيانات من النسخة المختارة."})}finally{c(!1)}};if(R)return(0,a.jsxs)("div",{className:"flex justify-center items-center min-h-[calc(100vh-8rem)]",children:[(0,a.jsx)(d.A,{className:"ms-2 h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{className:"ps-3",children:"جارٍ التحقق..."})]});let V=z?"مرحباً بك كضيف في عهدة":"مرحباً بك في عهدة",U=z?"يمكنك تجربة تسجيل رحلة واحدة وحساب معاملاتها. لحفظ رحلات متعددة ومزامنتها، يرجى تسجيل الدخول أو إنشاء حساب.":"نظامك المتكامل لتتبع وإدارة عهدات الرحلات بسهولة ودقة.";return(0,a.jsxs)("div",{className:"container mx-auto flex flex-col items-center justify-center min-h-[calc(100vh-8rem)] p-4 md:p-8",children:[(0,a.jsxs)("div",{className:"mb-12 text-center",children:[(0,a.jsx)(n.A,{}),(0,a.jsx)("h1",{className:"text-4xl font-bold tracking-tight mt-6",children:V}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 text-lg",children:U})]}),(0,a.jsxs)("div",{className:"space-y-6 w-full max-w-md text-center",children:[(0,a.jsx)("p",{className:"text-xl font-semibold",children:"ابدأ الآن:"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsx)(l(),{href:"/manage-trip?new=true",passHref:!0,children:(0,a.jsxs)(i.$,{size:"lg",className:"w-full sm:w-auto text-lg py-7 px-8 shadow-lg hover:shadow-xl transition-shadow",children:[(0,a.jsx)(o.A,{className:"ms-2 h-6 w-6"}),z?"تجربة تسجيل رحلة":"تسجيل رحلة جديدة"]})}),!z&&(0,a.jsx)(l(),{href:"/saved-trips",children:(0,a.jsxs)(i.$,{size:"lg",variant:"outline",className:"w-full sm:w-auto text-lg py-7 px-8 shadow-lg hover:shadow-xl transition-shadow",children:[(0,a.jsx)(u,{className:"ms-2 h-6 w-6"}),"الرحلات السابقة"]})})]}),!z&&(0,a.jsxs)("div",{className:"pt-8 border-t mt-8",children:[(0,a.jsx)("p",{className:"text-xl font-semibold mb-4",children:"إدارة البيانات (على الخادم):"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsxs)(i.$,{onClick:I,disabled:t||z,size:"lg",variant:"secondary",className:"w-full sm:w-auto text-lg py-7 px-8 shadow-md hover:shadow-lg transition-shadow",children:[t?(0,a.jsx)(d.A,{className:"ms-2 h-5 w-5 animate-spin"}):(0,a.jsx)(p,{className:"ms-2 h-6 w-6"}),t?"جارٍ الحفظ...":"إنشاء نسخة احتياطية على الخادم"]}),(0,a.jsxs)(i.$,{onClick:()=>A(!0),disabled:r||z,size:"lg",variant:"secondary",className:"w-full sm:w-auto text-lg py-7 px-8 shadow-md hover:shadow-lg transition-shadow",children:[(0,a.jsx)(m,{className:"ms-2 h-6 w-6"}),"استعادة نسخة من الخادم"]})]})]})]}),(0,a.jsx)(v.lG,{open:k&&!z,onOpenChange:e=>{A(e),e||(M([]),C(void 0))},children:(0,a.jsxs)(v.Cf,{children:[(0,a.jsxs)(v.c7,{children:[(0,a.jsx)(v.L3,{children:"استعادة البيانات من نسخة احتياطية على الخادم"}),(0,a.jsx)(v.rr,{children:"اختر نسخة احتياطية من القائمة أدناه. سيتم استبدال جميع الرحلات الحالية ببيانات النسخة المختارة."})]}),(0,a.jsx)("div",{className:"grid gap-4 py-4",children:E?(0,a.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,a.jsx)(d.A,{className:"ms-2 h-5 w-5 animate-spin"}),(0,a.jsx)("span",{children:"جاري تحميل قائمة النسخ..."})]}):S.length>0?(0,a.jsxs)("div",{className:"grid grid-cols-1 items-center gap-4",children:[(0,a.jsx)(j.J,{htmlFor:"backupSelect",className:"text-right col-span-1",children:"اختر نسخة"}),(0,a.jsxs)(b.l6,{value:T,onValueChange:C,dir:"rtl",children:[(0,a.jsx)(b.bq,{id:"backupSelect",children:(0,a.jsx)(b.yv,{placeholder:"اختر نسخة احتياطية..."})}),(0,a.jsx)(b.gC,{children:S.map(e=>(0,a.jsxs)(b.eb,{value:e.id,children:[e.backup_name," (تاريخ الإنشاء: ",(0,w.GP)(new Date(e.created_at),"PPpp",{locale:N.G}),")"]},e.id))})]})]}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center p-4",children:"لا توجد نسخ احتياطية متاحة على الخادم."})}),(0,a.jsxs)(v.Es,{children:[(0,a.jsx)(v.HM,{asChild:!0,children:(0,a.jsx)(i.$,{variant:"outline",onClick:()=>{M([]),C(void 0)},children:"إلغاء"})}),(0,a.jsxs)(i.$,{onClick:P,disabled:!T||r||E,children:[r?(0,a.jsx)(d.A,{className:"ms-2 h-4 w-4 animate-spin"}):null,r?"جارٍ الاستعادة...":"استعادة النسخة المختارة"]})]})]})})]})}},4165:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>h,HM:()=>u,L3:()=>x,c7:()=>f,lG:()=>d,rr:()=>y,zM:()=>o});var a=s(5155),r=s(2115),l=s(5452),i=s(5318),n=s(9434);let d=l.bL,o=l.l9,c=l.ZL,u=l.bm,p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});p.displayName=l.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...d}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(p,{}),(0,a.jsxs)(l.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...d,children:[r,(0,a.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.UC.displayName;let f=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};f.displayName="DialogHeader";let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};h.displayName="DialogFooter";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});x.displayName=l.hE.displayName;let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});y.displayName=l.VY.displayName},4301:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},5057:(e,t,s)=>{"use strict";s.d(t,{J:()=>o});var a=s(5155),r=s(2115),l=s(968),i=s(2085),n=s(9434);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.b,{ref:t,className:(0,n.cn)(d(),s),...r})});o.displayName=l.b.displayName},5908:(e,t,s)=>{Promise.resolve().then(s.bind(s,1728))},7481:(e,t,s)=>{"use strict";s.d(t,{dj:()=>p});var a=s(2115);let r=0,l=new Map,i=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],o={toasts:[]};function c(e){o=n(o,e),d.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function p(){let[e,t]=a.useState(o);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},8809:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("WalletMinimal",[["path",{d:"M17 14h.01",key:"7oqj8z"}],["path",{d:"M7 7h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14",key:"u1rqew"}]])},9409:(e,t,s)=>{"use strict";s.d(t,{bq:()=>p,eb:()=>x,gC:()=>h,l6:()=>c,yv:()=>u});var a=s(5155),r=s(2115),l=s(4582),i=s(9556),n=s(7381),d=s(518),o=s(9434);let c=l.bL;l.YJ;let u=l.WT,p=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(l.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[r,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]})});p.displayName=l.l9.displayName;let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});m.displayName=l.PP.displayName;let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})});f.displayName=l.wn.displayName;let h=r.forwardRef((e,t)=>{let{className:s,children:r,position:i="popper",...n}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:i,...n,children:[(0,a.jsx)(m,{}),(0,a.jsx)(l.LM,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(f,{})]})})});h.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.JU,{ref:t,className:(0,o.cn)("py-1.5 ps-8 pe-2 text-sm font-semibold",s),...r})}).displayName=l.JU.displayName;let x=r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(l.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 ps-2 pe-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,a.jsxs)("span",{className:"absolute end-2 flex h-3.5 w-3.5 items-center justify-center",children:[" ",(0,a.jsx)(l.VF,{children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})]}),(0,a.jsx)(l.p4,{children:r})]})});x.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=l.wv.displayName},9434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(2596),r=s(9688);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},9435:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(5155),r=s(8809);function l(){return(0,a.jsxs)("div",{className:"flex items-center space-x-2","data-ai-hint":"logo finance",children:[(0,a.jsx)(r.A,{className:"h-7 w-7 text-primary"}),(0,a.jsx)("span",{className:"text-xl font-bold text-primary tracking-tight",children:"عهدة"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[856,239,370,429,441,684,358],()=>t(5908)),_N_E=e.O()}]);